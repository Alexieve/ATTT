SELECT * FROM SINHVIEN
WHERE MASV = 'SV00000102';
UPDATE SINHVIEN
SET SOTCTL = (
    SELECT SUM(HP.SOTC)
    FROM DANGKY DK
    JOIN HOCPHAN HP ON DK.MAHP = HP.MAHP
    WHERE DK.MASV = SINHVIEN.MASV
    AND DK.DIEMTK IS NOT NULL
)
WHERE EXISTS (
    SELECT 1
    FROM DANGKY DK
    JOIN HOCPHAN HP ON DK.MAHP = HP.MAHP
    WHERE DK.MASV = SINHVIEN.MASV
    AND DK.DIEMTK IS NOT NULL
);

UPDATE SINHVIEN
SET DTBTL = (
    SELECT SUM(DK.DIEMTK) / COUNT(*)
    FROM DANGKY DK
    JOIN HOCPHAN HP ON DK.MAHP = HP.MAHP
    WHERE DK.MASV = SINHVIEN.MASV
    AND DK.DIEMTK IS NOT NULL
)
WHERE EXISTS (
    SELECT 1
    FROM DANGKY DK
    JOIN HOCPHAN HP ON DK.MAHP = HP.MAHP
    WHERE DK.MASV = SINHVIEN.MASV
    AND DK.DIEMTK IS NOT NULL
);
